<!DOCTYPE html>
<html>
<body>
<section id="main_view" style="display: none">
    <h1>–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –∏ –æ–ø–ª–∞—Ç–∞</h1>
    <hr>
    <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–∞–∑–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.</p>
    <p class="mono">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞:</p>
    <textarea id="reason" type="text" class="text_input" rows="8" oninput="areFieldsFilled()"></textarea>
    <p></p>
    <button disabled id="save_btn" onclick="declineRequest()">
        üö´ –û—Ç–∫–ª–æ–Ω–∏—Ç—å
    </button>
</section>
</body>
<script>
    let request = {};
    $.when(getRequest()).done(() => {
        $('#main_view').fadeIn(100);
    })

    function areFieldsFilled() {
        if (!$('#reason').val()) {
            $('#save_btn').prop('disabled', true);
        } else {
            $('#save_btn').prop('disabled', false);
        }
    }


    function declineRequest() {
        $('#save_btn').prop('disabled', true);
        let data = {
            reason: $('#reason').val(),
            request_id: request.id
        }
        return ajax('/declineRequest', data, () => {
            Telegram.WebApp.showAlert('‚úÖ –í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫–ª–æ–Ω–∏–ª–∏ –∑–∞–ø—Ä–æ—Å.\n–§–æ—Ä–º–∞ –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–∞.');
            Telegram.WebApp.close();
        });
    }
</script>
</html>